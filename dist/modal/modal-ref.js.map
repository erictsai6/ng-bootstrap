{"version":3,"sources":["../../src/modal/modal-ref.ts"],"names":[],"mappings":"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","file":"modal-ref.js","sourceRoot":"","sourcesContent":["import {Injectable, ComponentRef} from '@angular/core';\n\nimport {NgbModalBackdrop} from './modal-backdrop';\nimport {NgbModalWindow} from './modal-window';\n\nimport {ContentRef} from '../util/popup';\n\n/**\n * A reference to an active (currently opened) modal. Instances of this class\n * can be injected into components passed as modal content.\n */\n\nexport class NgbActiveModal {\n  /**\n   * Can be used to close a modal, passing an optional result.\n   */\n  close(result?: any): void {}\n\n  /**\n   * Can be used to dismiss a modal, passing an optional reason.\n   */\n  dismiss(reason?: any): void {}\nstatic decorators: DecoratorInvocation[] = [\n{ type: Injectable },\n];\n/** @nocollapse */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n];\n}\n\n/**\n * A reference to a newly opened modal.\n */\n\nexport class NgbModalRef {\n  private _resolve: (result?: any) => void;\n  private _reject: (reason?: any) => void;\n\n  /**\n   * The instance of component used as modal's content.\n   * Undefined when a TemplateRef is used as modal's content.\n   */\n  get componentInstance(): any {\n    if (this._contentRef.componentRef) {\n      return this._contentRef.componentRef.instance;\n    }\n  }\n\n  // only needed to keep TS1.8 compatibility\n  set componentInstance(instance: any) {}\n\n  /**\n   * A promise that is resolved when a modal is closed and rejected when a modal is dismissed.\n   */\n  result: Promise<any>;\n\n  constructor(\n      private _windowCmptRef: ComponentRef<NgbModalWindow>, private _contentRef: ContentRef,\n      private _backdropCmptRef?: ComponentRef<NgbModalBackdrop>) {\n    _windowCmptRef.instance.dismissEvent.subscribe((reason: any) => { this.dismiss(reason); });\n\n    this.result = new Promise((resolve, reject) => {\n      this._resolve = resolve;\n      this._reject = reject;\n    });\n    this.result.then(null, () => {});\n  }\n\n  /**\n   * Can be used to close a modal, passing an optional result.\n   */\n  close(result?: any): void {\n    if (this._windowCmptRef) {\n      this._resolve(result);\n      this._removeModalElements();\n    }\n  }\n\n  /**\n   * Can be used to dismiss a modal, passing an optional reason.\n   */\n  dismiss(reason?: any): void {\n    if (this._windowCmptRef) {\n      this._reject(reason);\n      this._removeModalElements(reason);\n    }\n  }\n\n  private _removeModalElements(reason?: any) {\n    const windowNativeEl = this._windowCmptRef.location.nativeElement;\n\n    windowNativeEl.classList.remove('show');\n    const delay = (reason && reason.reason === 'AUTOCLOSE') ? 0 : 250;\n\n    setTimeout(() => {\n      windowNativeEl.parentNode.removeChild(windowNativeEl);\n      this._windowCmptRef.destroy();\n\n      if (this._backdropCmptRef) {\n        const backdropNativeEl = this._backdropCmptRef.location.nativeElement;\n        backdropNativeEl.parentNode.removeChild(backdropNativeEl);\n        this._backdropCmptRef.destroy();\n      }\n\n      if (this._contentRef && this._contentRef.viewRef) {\n        this._contentRef.viewRef.destroy();\n      }\n\n      this._windowCmptRef = null;\n      this._backdropCmptRef = null;\n      this._contentRef = null;\n    }, delay);\n  }\nstatic decorators: DecoratorInvocation[] = [\n{ type: Injectable },\n];\n/** @nocollapse */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n{type: ComponentRef, },\n{type: ContentRef, },\n{type: ComponentRef, },\n];\n}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}